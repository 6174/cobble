<!DOCTYPE html>
<html>
	<head>
		<meta charset="uft-8">
		<title>
			test spy
		</title>
		<script src="../src/lib/sea.js">
		</script>
		<script src="seajsConfig.js">
		</script>
		<!-- // <script src="../src/qt.js"></script> -->
	</head>
	<body>
		<script type="text/javascript">
	seajs.use(['cobble', 'spy' , 'jquery'], function(cobble, spy) {
	 	/**
	 	 * @test
	 	 * test cobble func context
	 	 */
	 	cobble("test suit name", function() {
	 		log(this);
	 		log('this is a test suit action');
	 	});


	 	/**
	 	 * @test
	 	 * test cobble func with action and spy
	 	 */
	 	window.spy = spy;
	 	cobble("test equal func", {
	 		spy: function() {
	 			log('step:spy');
	 			var self = this;

	 			self.watch('namespace.sum', function(callshot) {
	 				var result = callshot.result; 
	 				var func = self.pattern({
	 					'1, 2': function(){
		 					log('matched');
		 					self.assert.equal(result, 3, "1 + 2 = 3");
	 					},
	 					'2, 3': function(){
		 					self.assert.equal(result, 5, "2 + 3 = 5");
	 					}
	 				});
	 				func.apply(self, callshot.args);
	 			});
	 		},
	 		action: function() {
	 			console.log('step:action');
	 			this.robot
	 			.wait(1).then(function() {
	 				var sum = spy(function sum(a, b) {
	 					return a + b;
	 				}, 'namespace.');
	 				sum(1, 2);
	 				sum(2, 3);
	 			})
	 			.wait(1).then(function() {
	 				console.log('second then');
	 			}).done();
	 		},
	 		finish: function() {
	 			log('step:finish');
	 			this.assert.equal(1, 1, '1 等于 1');
	 		}
	 	});

	 	cobble.startTest();
	 });

	 function log(info) {
	 	console.log(info);
	 }
		</script>
	</body>

</html>
>