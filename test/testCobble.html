<!DOCTYPE html>
<html>
	<head>
		<meta charset="uft-8">
		<title>
			test spy
		</title>
		<script src="../src/lib/sea.js">
		</script>
		<script src="seajsConfig.js">
		</script>
		<!-- // <script src="../src/qt.js"></script> -->
	</head>
	<body>
		<script type="text/javascript">
	seajs.use(['cobble', 'spy', 'jquery'], function(cobble, spy) {
	 	/**
	 	 * @test
	 	 * test cobble func context
	 	 */
	 	cobble.describe("test suit name", function() {

	 		cobble.it('a test spec', function(){
 				expect({ a: 'b' }).to.eql({ a: 'd' });
 				expect({ a: 'b' }).to.eql({ a: 'c' });
 			});

 			cobble.it('a test spec', function(){
 				expect(true).to.eql(true);
 			});
	 	});

	 	/**
	 	 * @test
	 	 * test cobble func with action and spy
	 	 */
	 	window.spy = spy;
	 	cobble.describe("test equal func", {
	 		spy: function() {
	 			this.watch('namespace.sum', {
	 				'1, 2': function(){
	 					cobble.it('1 + 2 should be 3', function(){
		 					expect(this.result).to.eql(4);
	 					});
	 				},
	 				'2, 3': function(){
	 					cobble.it('2 + 3 should be 5', function(){
	 						expect(this.result).to.eql(5);
	 					});
	 				}
	 			});
	 		},
	 		action: function() {
	 			var self = this;
	 			self.robot
	 			.wait(1)
	 			.then(function(){
	 				var sum = spy(function sum(a, b) {
	 					return a + b;
	 				}, 'namespace.');
	 				sum(1, 2);
	 				sum(2, 3);
	 			})
	 			.wait(1)
	 			.then(function() {
	 				cobble.it('sum should called three times', function(){
	 					expect(cobble.spy('namespace.sum').calledTwice()).to.be.ok();
	 				});
	 			}).done();
	 		}
	 	});

	 	cobble.startTest();
	 });

	 function log(info) {
	 	console.log(info);
	 }
		</script>
	</body>

</html>
>