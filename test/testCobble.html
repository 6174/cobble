<!DOCTYPE html>
<html>
	<head>
		<meta charset="uft-8">
		<title>
			test spy
		</title>
		<script src="../src/lib/sea.js">
		</script>
		<script src="seajsConfig.js">
		</script>
		<!-- // <script src="../src/qt.js"></script> -->
	</head>
	<body>
		<script type="text/javascript">
	seajs.use(['cobble', 'spy', 'jquery'], function(cobble, spy) {
	 	/**
	 	 * @test
	 	 * test cobble func context
	 	 */
	 	cobble.describe("test suit name", function() {
	 		// log(this);
	 		cobble.it('a test spec', function(){
 				expect({ a: 'b' }).to.eql({ a: 'd' });
 				expect({ a: 'b' }).to.eql({ a: 'c' });
 			});

 			cobble.it('a test spec', function(){
 				expect(true).to.eql(true);
 			});

	 	});

	 	/**
	 	 * @test
	 	 * test cobble func with action and spy
	 	 */
	 	window.spy = spy;
	 	cobble.describe("test equal func", {
	 		spy: function() {
	 			log('step:spy');
	 			var self = this;
	 			self.watch('namespace.sum', function(callshot) {
	 				var result = callshot.result; 
	 				var func = cobble.pattern({
	 					'1, 2': function(){
		 					log('matched');
		 					try{
			 					expect({ a: 'b' }).to.eql({ a: 'a' });
		 					} catch(e){
		 						window.me = e;
		 					}
	 					},
	 					'2, 3': function(){
	 					}
	 				});
	 				func.apply(self, callshot.args);
	 			});
	 		},
	 		action: function() {
	 			console.log('step:action');
	 			this.robot
	 			.then(function(){
	 				var sum = spy(function sum(a, b) {
	 					return a + b;
	 				}, 'namespace.');
	 				sum(1, 2);
	 				sum(2, 3);
	 			})
	 			.wait(1).then(function() {
	 				console.log('second then');
	 			}).done();
	 		},
	 		finish: function() {
	 			log('step:finish');
	 		}
	 	});

	 	cobble.startTest();
	 });

	 function log(info) {
	 	console.log(info);
	 }
		</script>
	</body>

</html>
>